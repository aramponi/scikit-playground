import pandas, numpy as np
ewma = pandas.stats.moments.ewma

x = [0.15360063,0.30720109,0.27648032,0.30208101,0.29184115,0.26880111,0.28160061,0.8704049,0.11776048,0.8704032,0.25856110,0.25344111,0.25600105,0.28160103,0.15616034,0.21760084,0.17920045,0.14336034,0.16128062,0.2560060,0.27904111,0.25600117,0.27648101,0.8192116,0.30976112,0.25856061,0.8704074,0.16640086,0.16640095,0.19712079,0.17408085,0.19456069,0.8704032,0.30208101,0.29184115,0.26880111,0.28160061,0.8704052,0.8704062,0.2560032,0.8192060,0.25344111,0.27904112,0.28416110,0.25856110,0.29696032,0.28160097,0.27904101,0.15616034,0.19968101,0.30464077,0.28416100,0.29952108,0.25856082,0.28416111,0.29696077,0.24832110,0.24832103,0.25856114,0.8704032,0.26880110,0.26624101,0.29184105,0.29696045,0.25344111,0.27904112,0.26880108,0.25856114,0.11520111,0.29952116,0.28672117,0.29696061,0.8704116,0.29184117,0.25856034,0.15872010,0.8192032,0.8192032,0.15360101,0.30720099,0.27648117,0.25600101,0.11520111,0.29952116,0.28672117,0.29696032,0.12032062,0.2560032,0.8192032,0.8192060,0.25344111,0.28160116,0.25856110,0.29696032,0.29952114,0.27648061,0.8704102,0.26880108,0.25856058,0.12032047 ,0.9216077,0.20224068,0.21760076,0.17664095,0.17408073,0.20992036,0.8704062,0.2560032,0.8192032,0.8192032,0.8192060,0.29440111,0.29952114,0.25344101,0.17920111,0.27648100,0.25856114,0.8192117,0.29184108,0.15616034,0.26112105,0.27648101,0.14848047,0.12032036,0.19712079,0.17408085,0.19456069,0.24320068,0.18688082,0.9216047,0.29440114,0.25344034,0.8192105,0.29440084,0.25856115,0.29696083,0.28416117,0.29184099,0.25856061,0.8704102,0.24832108,0.29440101,0.8704032,0.12032062,0.2560032,0.8192032,0.8192060,0.12032099,0.28416110,0.29696101,0.28160116,0.15872010,0.8192032,0.8192032,0.15360111,0.29184100,0.25856114,0.17664110,0.29696114,0.30976032,0.29696121,0.28672101,0.15616034,0.26880110,0.26624101,0.29184105,0.29696101,0.25600074,0.25600107,0.8704032,0.12032062,0.2560032,0.8192032,0.8192060,0.28416114,0.25600101,0.29184069,0.28160116,0.29184121,0.8192116,0.30976112,0.25856061,0.8704115,0.28416117,0.29184099,0.25856070,0.28416108,0.25600101,0.29184034,0.8192102,0.28416114,0.21504101,0.29440116,0.29440061,0.8704102,0.24832108,0.29440101,0.8704032,0.12032062,0.2560032 ,0.8192060,0.12032099,0.28416109,0.28672111,0.28160101,0.28160116,0.15872010,0.15360047,0.27904111,0.25600117,0.27648101,0.15872]
plot( x, alpha=0.4, label='Raw' )

# take EWMA in both directions with a smaller span term
fwd = ewma( x, span=15 )          # take EWMA in fwd direction
bwd = ewma( x[::-1], span=15 )    # take EWMA in bwd direction
c = np.vstack(( fwd, bwd[::-1] )) # lump fwd and bwd together
c = np.mean( c, axis=0 )          # average  

# regular EWMA, with bias against trend
plot( ewma( x, span=20 ), 'b', label='EWMA, span=20' )

# "corrected" (?) EWMA
plot( c, 'r', label='Reversed-Recombined' )

legend(loc=8)
savefig( 'ewma_correction.png', fmt='png', dpi=100 )
